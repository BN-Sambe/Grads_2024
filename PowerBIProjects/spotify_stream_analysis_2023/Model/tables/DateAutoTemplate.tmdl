table DateAutoTemplate
	isHidden
	dataCategory: Time

	column Date
		dataType: dateTime
		isHidden
		isKey
		formatString: m/d/yyyy
		dataCategory: PaddedDateTableDates
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Date]

		annotation SQLBI_AttributeTypes = Date

	column Year
		dataType: int64
		isHidden
		dataCategory: Years
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Year]

	column 'Year Quarter Number'
		dataType: int64
		isHidden
		dataCategory: Quarters
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Year Quarter Number]

	column 'Year Quarter'
		dataType: string
		isHidden
		dataCategory: Quarters
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Year Quarter]
		sortByColumn: 'Year Quarter Number'

	column Quarter
		dataType: string
		isHidden
		dataCategory: QuarterOfYear
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Quarter]

	column 'Year Month'
		dataType: string
		isHidden
		dataCategory: Months
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Year Month]
		sortByColumn: 'Year Month Number'

	column 'Year Month Number'
		dataType: int64
		isHidden
		dataCategory: Months
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Year Month Number]

	column Month
		dataType: string
		isHidden
		dataCategory: MonthOfYear
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Month]
		sortByColumn: 'Month Number'

	column 'Month Number'
		dataType: int64
		isHidden
		dataCategory: MonthOfYear
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Month Number]

	column 'Day of Week Number'
		dataType: int64
		isHidden
		dataCategory: DayOfWeek
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Day of Week Number]

		annotation SQLBI_AttributeTypes = DayOfWeek

		annotation SQLBI_FilterSafe = True

	column 'Day of Week'
		dataType: string
		isHidden
		dataCategory: DayOfWeek
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [Day of Week]
		sortByColumn: 'Day of Week Number'

		annotation SQLBI_FilterSafe = True

	column DateWithTransactions
		dataType: boolean
		isHidden
		summarizeBy: none
		isNameInferred
		isDataTypeInferred
		sourceColumn: [DateWithTransactions]

		annotation SQLBI_AttributeTypes = DateDuration

	hierarchy Calendar
		isHidden

		level Year
			column: Year

		level Month
			column: 'Year Month'

		level Date
			column: Date

	partition DateAutoTemplate = calculated
		mode: import
		source =
				
				--
				--     Configuration
				--
				VAR __FirstDayOfWeek = 0
				----------------------------------------
				VAR __WeekDayCalculationType = IF ( __FirstDayOfWeek = 0, 7, __FirstDayOfWeek ) + 10
				VAR __Calendar =
				    VAR __FirstYear = YEAR ( MINX ( { MIN ( 'Spotify_Dataset'[Date] ) }, ''[Value] ) )
				    VAR __LastYear =  YEAR ( MAXX ( { MAX ( 'Spotify_Dataset'[Date] ) }, ''[Value] ) )
				    RETURN CALENDAR (
				        DATE ( __FirstYear, 1, 1 ),
				        DATE ( __LastYear, 12, 31 )
				    )
				VAR __Step3 =
				    GENERATE (
				        __Calendar,
				        VAR __IsStandardLocale = IF ( FORMAT( DATE( 2000, 1, 1 ), "oooo" ) = "oooo", TRUE, FALSE )
				        VAR __MonthFormatString = IF( __IsStandardLocale, "mmm", "ooo" )
				        VAR __DayFormatString = IF( __IsStandardLocale, "ddd", "aaa" )
				        VAR __LastTransactionDate = MAXX ( { MAX ( 'Spotify_Dataset'[Date] ) }, ''[Value] )
				        VAR __Date = [Date]
				        VAR __YearNumber = YEAR ( __Date )
				        VAR __QuarterNumber = QUARTER ( __Date )
				        VAR __YearQuarterNumber = CONVERT ( __YearNumber * 4 + __QuarterNumber - 1, INTEGER )
				        VAR __MonthNumber = MONTH ( __Date )
				        VAR __WeekDayNumber = WEEKDAY ( __Date, __WeekDayCalculationType )
				        VAR __WeekDay = FORMAT ( __Date, __DayFormatString )
				        RETURN ROW (
				            "Year", __YearNumber,
				            "Year Quarter Number", __YearQuarterNumber,
				            "Year Quarter", FORMAT ( __QuarterNumber, "\Q0" ) & "-" & FORMAT ( __YearNumber, "0000" ),
				            "Quarter", FORMAT( __QuarterNumber, "\Q0" ),
				            "Year Month", FORMAT ( __Date, __MonthFormatString & " yyyy" ),
				            "Year Month Number", __YearNumber * 12 + __MonthNumber - 1,
				            "Month", FORMAT ( __Date, __MonthFormatString ),
				            "Month Number", __MonthNumber,
				            "Day of Week Number", __WeekDayNumber,
				            "Day of Week", __WeekDay,
				            "DateWithTransactions", __Date <= __LastTransactionDate
				        )
				    )
				RETURN
				    __Step3

	annotation SQLBI_Template = Dates

	annotation SQLBI_TemplateTable = DateAutoTemplate

	annotation SQLBI_CalendarType = Calendar

